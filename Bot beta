-- WARNING: Using cheats in games violates Roblox TOS and can result in bans. Use at your own risk!

local Players = game:GetService("Players")
local Player = Players.LocalPlayer
local VirtualUser = game:GetService("VirtualUser")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")

-- Variables
local autoFarmActive = false
local bunnyHopActive = false
local hitboxReachActive = false
local protectFriends = false
local targetPlayerName = ""
local reachDistance = 25

-- ScreenGui
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "SlapBattlesMech"
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = game:GetService("CoreGui")

-- ==== "Made by AlyaProvider" Intro Text (shows once at start) ====
local IntroLabel = Instance.new("TextLabel")
IntroLabel.Size = UDim2.new(0, 400, 0, 100)
IntroLabel.Position = UDim2.new(0.5, -200, 0.5, -50)
IntroLabel.BackgroundTransparency = 1
IntroLabel.Text = "Made by AlyaProvider"
IntroLabel.TextColor3 = Color3.fromRGB(255, 100, 140)
IntroLabel.Font = Enum.Font.GothamBlack
IntroLabel.TextSize = 40
IntroLabel.TextTransparency = 1
IntroLabel.TextStrokeTransparency = 1
IntroLabel.TextStrokeColor3 = Color3.new(0,0,0)
IntroLabel.Parent = ScreenGui

-- Fade in + Fade out animation (only once)
local fadeIn = TweenService:Create(IntroLabel, TweenInfo.new(1, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
    TextTransparency = 0,
    TextStrokeTransparency = 0
})
local fadeOut = TweenService:Create(IntroLabel, TweenInfo.new(1, Enum.EasingStyle.Quad, Enum.EasingDirection.In), {
    TextTransparency = 1,
    TextStrokeTransparency = 1
})

fadeIn:Play()
fadeIn.Completed:Connect(function()
    wait(1.5)  -- Show for a moment
    fadeOut:Play()
    fadeOut.Completed:Connect(function()
        IntroLabel:Destroy()  -- Remove after animation
    end)
end)

-- Open Button: Black circle with ðŸ› 
local OpenButton = Instance.new("TextButton")
OpenButton.Size = UDim2.new(0, 70, 0, 70)
OpenButton.Position = UDim2.new(1, -90, 1, -90)
OpenButton.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
OpenButton.Text = "ðŸ› "
OpenButton.TextColor3 = Color3.new(1,1,1)
OpenButton.Font = Enum.Font.SourceSansBold
OpenButton.TextSize = 40
OpenButton.TextStrokeTransparency = 0.7
OpenButton.TextStrokeColor3 = Color3.new(0,0,0)
OpenButton.Parent = ScreenGui

local openCorner = Instance.new("UICorner", OpenButton)
openCorner.CornerRadius = UDim.new(1, 0)

local openGlow = Instance.new("UIStroke", OpenButton)
openGlow.Color = Color3.fromRGB(100, 100, 255)
openGlow.Thickness = 4
openGlow.Transparency = 0.5

local shadow = Instance.new("Frame")
shadow.Size = UDim2.new(1, 8, 1, 8)
shadow.Position = UDim2.new(0, 4, 0, 4)
shadow.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
shadow.BackgroundTransparency = 0.7
shadow.ZIndex = OpenButton.ZIndex - 1
shadow.Parent = OpenButton
local shadowCorner = Instance.new("UICorner", shadow)
shadowCorner.CornerRadius = UDim.new(1, 0)

-- Main Frame
local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(0, 560, 0, 420)
MainFrame.Position = UDim2.new(0.5, -280, 0.5, -210)
MainFrame.BackgroundColor3 = Color3.fromRGB(18, 18, 22)
MainFrame.Visible = false
MainFrame.BackgroundTransparency = 1  -- Start invisible for animation
MainFrame.Parent = ScreenGui

local mc = Instance.new("UICorner", MainFrame)
mc.CornerRadius = UDim.new(0, 18)

local border = Instance.new("UIStroke", MainFrame)
border.Color = Color3.fromRGB(255, 60, 100)
border.Thickness = 5

-- Title Bar
local TitleBar = Instance.new("Frame")
TitleBar.Size = UDim2.new(1, 0, 0, 70)
TitleBar.BackgroundColor3 = Color3.fromRGB(255, 40, 80)
TitleBar.Parent = MainFrame
local tc = Instance.new("UICorner", TitleBar)
tc.CornerRadius = UDim.new(0, 18)

local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1, -100, 1, 0)
Title.Position = UDim2.new(0, 25, 0, 0)
Title.BackgroundTransparency = 1
Title.Text = "Slap Battles Mech"
Title.TextColor3 = Color3.new(1,1,1)
Title.Font = Enum.Font.GothamBlack
Title.TextSize = 28
Title.TextXAlignment = Enum.TextXAlignment.Left
Title.Parent = TitleBar

local titleStroke = Instance.new("UIStroke", Title)
titleStroke.Color = Color3.new(0,0,0)
titleStroke.Thickness = 3

local CloseButton = Instance.new("TextButton")
CloseButton.Size = UDim2.new(0, 50, 0, 50)
CloseButton.Position = UDim2.new(1, -65, 0.5, -25)
CloseButton.BackgroundColor3 = Color3.fromRGB(255, 80, 80)
CloseButton.Text = "X"
CloseButton.TextColor3 = Color3.new(1,1,1)
CloseButton.Font = Enum.Font.GothamBlack
CloseButton.TextSize = 24
CloseButton.Parent = TitleBar
local cc = Instance.new("UICorner", CloseButton)
cc.CornerRadius = UDim.new(0, 12)

-- Creator Label
local CreatorLabel = Instance.new("TextLabel")
CreatorLabel.Size = UDim2.new(1, 0, 0, 40)
CreatorLabel.Position = UDim2.new(0, 0, 1, -40)
CreatorLabel.BackgroundTransparency = 1
CreatorLabel.Text = "Creator: AlyaProvider"
CreatorLabel.TextColor3 = Color3.fromRGB(180, 180, 180)
CreatorLabel.Font = Enum.Font.Gotham
CreatorLabel.TextSize = 16
CreatorLabel.Parent = MainFrame

local creatorStroke = Instance.new("UIStroke", CreatorLabel)
creatorStroke.Color = Color3.new(0,0,0)
creatorStroke.Thickness = 2

-- Draggable
local dragging = false
local dragStart, startPos
TitleBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = MainFrame.Position
    end
end)
TitleBar.InputChanged:Connect(function(input)
    if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
        local delta = input.Position - dragStart
        MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)
UserInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = false
    end
end)

-- ==== Menu Open/Close with Smooth Animation ====
local function openMenu()
    MainFrame.Visible = true
    OpenButton.Visible = false
    
    local tweenIn = TweenService:Create(MainFrame, TweenInfo.new(0.4, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
        BackgroundTransparency = 0,
        Position = UDim2.new(0.5, -280, 0.5, -210)
    })
    tweenIn:Play()
end

local function closeMenu()
    local tweenOut = TweenService:Create(MainFrame, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.In), {
        BackgroundTransparency = 1,
        Position = UDim2.new(0.5, -280, 0.5, -300)  -- Slight slide up
    })
    tweenOut:Play()
    tweenOut.Completed:Connect(function()
        MainFrame.Visible = false
        OpenButton.Visible = true
    end)
end

OpenButton.MouseButton1Click:Connect(openMenu)
CloseButton.MouseButton1Click:Connect(closeMenu)

-- Toggle Creator
local function createToggle(name, xOffset, yPos, default, callback, activeColor, inactiveColor)
    local Frame = Instance.new("Frame")
    Frame.Size = UDim2.new(0, 250, 0, 60)
    Frame.Position = UDim2.new(0, xOffset, 0, yPos)
    Frame.BackgroundColor3 = Color3.fromRGB(28, 28, 35)
    Frame.Parent = MainFrame
    local fc = Instance.new("UICorner", Frame)
    fc.CornerRadius = UDim.new(0, 12)
    local fs = Instance.new("UIStroke", Frame)
    fs.Color = Color3.fromRGB(80, 80, 90)
    fs.Thickness = 2

    local Label = Instance.new("TextLabel")
    Label.Size = UDim2.new(0.65, 0, 1, 0)
    Label.BackgroundTransparency = 1
    Label.Text = name
    Label.TextColor3 = Color3.fromRGB(220, 220, 220)
    Label.Font = Enum.Font.GothamBold
    Label.TextSize = 20
    Label.TextXAlignment = Enum.TextXAlignment.Left
    Label.Position = UDim2.new(0, 18, 0, 0)
    Label.Parent = Frame

    local labelStroke = Instance.new("UIStroke", Label)
    labelStroke.Color = Color3.new(0,0,0)
    labelStroke.Thickness = 2

    local Button = Instance.new("TextButton")
    Button.Size = UDim2.new(0, 80, 0, 40)
    Button.Position = UDim2.new(1, -95, 0.5, -20)
    Button.BackgroundColor3 = default and activeColor or inactiveColor
    Button.Text = default and "ON" or "OFF"
    Button.TextColor3 = Color3.new(1,1,1)
    Button.Font = Enum.Font.GothamBold
    Button.TextSize = 18
    Button.Parent = Frame
    local bc = Instance.new("UICorner", Button)
    bc.CornerRadius = UDim.new(0, 10)
    local bs = Instance.new("UIStroke", Button)
    bs.Color = Color3.new(0,0,0)
    bs.Thickness = 2.5

    local active = default
    Button.MouseButton1Click:Connect(function()
        active = not active
        Button.BackgroundColor3 = active and activeColor or inactiveColor
        Button.Text = active and "ON" or "OFF"
        callback(active)
    end)
end

-- Textbox
local function createTextbox(name, xOffset, yPos, placeholder, default, callback)
    local Label = Instance.new("TextLabel")
    Label.Size = UDim2.new(0, 250, 0, 30)
    Label.Position = UDim2.new(0, xOffset, 0, yPos)
    Label.BackgroundTransparency = 1
    Label.Text = name
    Label.TextColor3 = Color3.fromRGB(220, 220, 220)
    Label.Font = Enum.Font.GothamBold
    Label.TextSize = 18
    Label.TextXAlignment = Enum.TextXAlignment.Left
    Label.Parent = MainFrame

    local labelStroke = Instance.new("UIStroke", Label)
    labelStroke.Color = Color3.new(0,0,0)
    labelStroke.Thickness = 2

    local Box = Instance.new("TextBox")
    Box.Size = UDim2.new(0, 250, 0, 55)
    Box.Position = UDim2.new(0, xOffset, 0, yPos + 35)
    Box.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
    Box.PlaceholderText = placeholder
    Box.Text = default or ""
    Box.TextColor3 = Color3.new(1,1,1)
    Box.Font = Enum.Font.GothamSemibold
    Box.TextSize = 18
    Box.TextYAlignment = Enum.TextYAlignment.Center
    Box.Parent = MainFrame
    local xc = Instance.new("UICorner", Box)
    xc.CornerRadius = UDim.new(0, 12)
    local xs = Instance.new("UIStroke", Box)
    xs.Color = Color3.new(0,0,0)
    xs.Thickness = 3

    Box.FocusLost:Connect(function(enter)
        if enter then callback(Box.Text) end
    end)
end

-- Controls
createToggle("Bot", 30, 90, false, function(v)
    autoFarmActive = v
    if v then spawn(startAutoFarm) end
end, Color3.fromRGB(50, 230, 80), Color3.fromRGB(220, 50, 50))

createToggle("Bunny Hop", 290, 90, false, function(v)
    bunnyHopActive = v
    if v then spawn(startBunnyHop) end
end, Color3.fromRGB(200, 70, 255), Color3.fromRGB(110, 40, 150))

createToggle("Protect Friends", 30, 175, false, function(v)
    protectFriends = v
end, Color3.fromRGB(255, 110, 200), Color3.fromRGB(160, 60, 130))

createToggle("Hitbox Reach", 290, 175, false, function(v)
    hitboxReachActive = v
    if v then spawn(startHitboxReach) else stopHitboxReach() end
end, Color3.fromRGB(70, 190, 255), Color3.fromRGB(40, 100, 160))

createTextbox("Target Player", 30, 260, "partial name...", "", function(v)
    targetPlayerName = v
end)

createTextbox("Reach Distance", 290, 260, "25", "25", function(v)
    local n = tonumber(v)
    if n and n > 0 then reachDistance = n end
end)

-- Original Bot & other functions remain unchanged
function startAutoFarm()
    spawn(function()
        while autoFarmActive do
            pcall(function()
                local player = game.Players.LocalPlayer
                local char = player.Character or player.CharacterAdded:Wait()
                local hum = char:FindFirstChild("Humanoid")
                local hrp = char:FindFirstChild("HumanoidRootPart")

                if char and hum and hrp and char:FindFirstChild("isInArena") then
                    if not char.isInArena.Value then
                        local portal = game.Workspace:FindFirstChild("Lobby"):FindFirstChild("Teleport1")
                        if portal then
                            hum:MoveTo(portal.Position)
                        end
                    else
                        local targetPlayer = nil
                        if targetPlayerName ~= "" then
                            targetPlayer = findPlayerByPartialName(targetPlayerName)
                        end

                        if not targetPlayer then
                            targetPlayer = findClosestPlayer(4000, hrp)
                        end

                        if targetPlayer and targetPlayer.Character then
                            if protectFriends and player:IsFriendsWith(targetPlayer.UserId) then
                                targetPlayer = nil
                            else
                                local targetHrp = targetPlayer.Character:FindFirstChild("HumanoidRootPart")
                                if targetHrp then
                                    hum:MoveTo(targetHrp.Position)
                                    mouseDown()
                                end
                            end
                        end
                    end
                end
            end)

            if math.random() < 0.1 then
                jump()
            end

            wait(0.1)
        end
    end)
end

local expandedHitboxes = {}

function startHitboxReach()
    spawn(function()
        while hitboxReachActive do
            pcall(function()
                for _, player in pairs(game.Players:GetPlayers()) do
                    if player ~= game.Players.LocalPlayer and player.Character then
                        local targetHrp = player.Character:FindFirstChild("HumanoidRootPart")
                        if targetHrp then
                            if protectFriends and game.Players.LocalPlayer:IsFriendsWith(player.UserId) then
                                continue
                            end
                            
                            local key = player.UserId .. "_" .. tick()
                            
                            if not expandedHitboxes[key] then
                                expandedHitboxes[key] = true
                                
                                if not targetHrp:GetAttribute("OriginalSize") then
                                    targetHrp:SetAttribute("OriginalSize", targetHrp.Size)
                                end
                                
                                targetHrp.Size = Vector3.new(reachDistance, reachDistance, reachDistance)
                                targetHrp.Transparency = 0.7
                                targetHrp.BrickColor = BrickColor.new("Bright red")
                                targetHrp.Material = Enum.Material.ForceField
                                targetHrp.CanCollide = false
                            end
                        end
                    end
                end
            end)
            wait(0.1)
        end
    end)
end

function stopHitboxReach()
    for _, player in pairs(game.Players:GetPlayers()) do
        if player.Character then
            local targetHrp = player.Character:FindFirstChild("HumanoidRootPart")
            if targetHrp and targetHrp:GetAttribute("OriginalSize") then
                targetHrp.Size = targetHrp:GetAttribute("OriginalSize")
                targetHrp.Transparency = 0
                targetHrp.BrickColor = BrickColor.new("Medium stone grey")
                targetHrp.Material = Enum.Material.SmoothPlastic
                targetHrp.CanCollide = true
            end
        end
    end
    expandedHitboxes = {}
end

function mouseDown()
    local virtualUser = game:GetService("VirtualUser")
    virtualUser:ClickButton1(Vector2.new(200, 200))
end

function jump()
    local player = game.Players.LocalPlayer
    local char = player.Character
    local hum = char:FindFirstChild("Humanoid")

    if hum and hum:GetState() == Enum.HumanoidStateType.Physics then
        hum:Move(Vector3.new(0, 20, 0))
    end
end

function findClosestPlayer(max, part)
    local lastDist = max
    local closest = nil

    for _, v in pairs(game.Players:GetPlayers()) do
        if v ~= nil and v.Character and v ~= game.Players.LocalPlayer then
            local targetChar = v.Character
            local targetHrp = targetChar:FindFirstChild("HumanoidRootPart")
            local targetHum = targetChar:FindFirstChildOfClass("Humanoid")

            if targetHrp and targetHum then
                if protectFriends and game.Players.LocalPlayer:IsFriendsWith(v.UserId) then
                    continue
                end

                local thisDist = (targetHrp.Position - part.Position).Magnitude

                if thisDist < lastDist then
                    closest = v
                    lastDist = thisDist
                end
            end
        end
    end
    return closest
end

function findPlayerByPartialName(partialName)
    for _, player in pairs(game.Players:GetPlayers()) do
        if player.Name:sub(1, #partialName) == partialName then
            if protectFriends and game.Players.LocalPlayer:IsFriendsWith(player.UserId) then
                return nil
            end
            return player
        end
    end
    return nil
end

function startBunnyHop()
    spawn(function()
        while bunnyHopActive do
            pcall(function()
                local player = game.Players.LocalPlayer
                local char = player.Character or player.CharacterAdded:Wait()
                local hum = char:FindFirstChild("Humanoid")

                if hum then
                    if hum:GetState() == Enum.HumanoidStateType.Physics then
                        hum:ChangeState(Enum.HumanoidStateType.Seated)
                    end
                    hum:Move(Vector3.new(0, 0, 0))
                    hum.Jump = true
                end
            end)
            wait(0)
        end
    end)
end
